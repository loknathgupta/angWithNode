<% include ../layout/header %>
    <!--Left Side Starts-->
    <div class="fix-left-side left-side-menu">
        <!--Logo Area Starts-->
        <% include ../layout/logo-section %>
            <!--Logo Area Ends-->
            <!--Left side Menu Starts-->
            <% include ../layout/left-menu %>
                <!--Left Menu Ends-->
    </div>
    <!--Left Side Ends-->


    <!--Header Right Menu starts-->
    <% include ../layout/header-right-menu %>
        <!--Header Right Menu Ends-->

        </div>
        <!--Right Side Header Ends-->

        <!--Content Wrapper Starts-->
        <div class="content-wrapper">
            <!-- <div class="page-name">
                <div class="col-lg-12 col-xs-12">
                    <div class="dashboard">Add Deliverables</div>
                </div>
            </div> -->
            <!-- Drag and Drog Functionality Div Starts-->
            <div class="sortable">
                <div class="col-md-12">
                    <!--editable starts-->
                    <div class="panel">
                        <div class="panel-heading">
                            Daily Inputs
                        </div>
                            <div class="panel-body">
                                
                                <form method="POST" action="" id="also_used_for_update">
                                    <div class="left filter">
                                        <label>Input the delivered job counts for</label>
                                        <input readonly type="text" name="delivery_for" id="delivery_for" value="<%= moment(dateData.dateSelected).format('DD-MM-YYYY')%>">
                                        
                                    </div>
                                    <div class="left filter ">
                                        
                                        <% if(retrievalRole == 'PM') {%>
                                            <label>Project Manager </label>
                                            <select class="" name="project_manager_id" id="manager_id">
                                                <option value="0">Select Manager</option>
                                                <% 
                                                managers.forEach(function(projectManager) {
                                                    let selected = '';
                                                    if(projectManager.id == dateData.projectManagerId){
                                                        selected = 'selected';
                                                    }
                                                %>
                                                    <option value="<%= projectManager.id %>" <%= selected%> ><%= projectManager.pm_name %></option>
                                                <% }); %>
                                            </select>      
                                        <%  }else if(retrievalRole == 'AM') {%>
                                            <label>Account Manager</label>
                                            <select class="" name="account_manager_id" id="manager_id">
                                                <% if(['AM', 'GM', 'PM'].indexOf(hasAccessUpTo) == -1) { %>
                                                <option value="All">All</option>
                                                <% }
                                                managers.forEach(function(accountManager) {
                                                    let selected = '';
                                                    if(accountManager.id == dateData.accountManagerId){
                                                        selected = 'selected';
                                                    }
                                                %>
                                                    <option value="<%= accountManager.id %>" <%= selected%> ><%= accountManager.am_name %></option>
                                                <% }); %>
                                            </select>      
                                        <% } %>    
                                    </div>
                                    <% if(retrievalRole == 'AM') {%>
                                    <div class="left filter">
                                        <label>Project Manger</label>
                                        <select name="asso_project_manager_id" class="asso_project_manager_id">
                                            <% PMOfSelectedAM.forEach(function(projectManager) {
                                                let selected = '';
                                                if(projectManager.id == 0){
                                                    selected = 'selected';
                                                }
                                            %>
                                                <option value="<%= projectManager.pm_name %>" <%= selected%> ><%= projectManager.pm_name %></option>
                                            <% }); %>
                                        </select>
                                    </div>
                                    <%}%> 
                                    <div class="left filter">
                                        <label>Client Status</label>
                                        <select name="client_status">
                                            <% 
                                            let selected;
                                            configuration.ClientStatus[0] = 'All';
                                            for(var key in configuration.ClientStatus) {
                                                selected = ''; 
                                                if(key == dateData.clientStatus){
                                                    selected = 'selected';
                                                }
                                            %>
                                                <option value="<%= key%>" <%= selected%> ><%= configuration.ClientStatus[key]%></option>
                                            <% } %>
                                        </select>
                                        
                                    </div>
                                    <% if(retrievalRole != 'AM') {%>
                                    <div class="left filter">
                                        <label>Pricing Head Status</label>
                                        <select name="price_head_status">
                                            <% 
                                            configuration.PricingHeadStatus['0'] = 'All';
                                            for(var key in configuration.PricingHeadStatus) {
                                                selected = ''; 
                                                if(key == dateData.priceHeadStatus){
                                                    selected = 'selected';
                                                }
                                            %>
                                                <option value="<%= key%>" <%= selected%> ><%= configuration.PricingHeadStatus[key]%></option>
                                            <% } %>
                                        </select>
                                        
                                    </div>
                                    <div class="left filter">
                                        <label><a href="#" data-toggle="modal" data-target="#popupSuspendedPrice">Suspended Price Heads</a></label>                                        
                                    </div>
                                    <% } var inputTotal = 0; %>
                                </form>
                                        
                            <br>
                                <form method="POST" action="/delivery/add" id="add-deliverables">
                                    <input type="hidden" name="dateSelected" value="<%= dateData.dateSelected %>">
                                    <input type="hidden" name="projectManagerId" value="<%= dateData.projectManagerId %>">
                                    <input type="hidden" id="loggedInUserType" name="loggedInUserType" value="<%= loggedInUserType %>">
                                    
                                    <table class="table table-striped table-hover table-bordered display dataTable no-footer table-fixed" id="dailyDeliverables">

                                        <thead>                                            
                                            <tr role="row">
                                                    <% 
                                                    let currentDate = new Date(dateData.dateSelected);
                                                    let selectedMonthName = moment(currentDate).format('MMMM');
                                                    currentDate.setDate(1);
                                                    currentDate.setMonth(currentDate.getMonth()-1);
                                                    let lastMonthName = moment(currentDate).format('MMMM');
                                                    %>
                                                    
                                                <th rowspan="2" width="15%">Client Name</th>
                                                <th rowspan="2">Pricing Head</th>
                                                <% if(retrievalRole == 'AM') {%>
                                                <th rowspan="2">PM</th>
                                                <%}%>    
                                                <th rowspan="2">U/M</th>                                                
                                                <th colspan="2" class="last_volumes">Projected Vol. for <%= selectedMonthName%></th>
                                                <!-- <th rowspan="2" class="last_volumes">Projected Vol. For <%= selectedMonthName%> bY AM</th> -->
                                                <th rowspan="2" class="last_volumes">Vol. In <%= lastMonthName%> </th>
                                                <th rowspan="2" class="last_volumes">MTD Vol.</th>
                                                <th colspan="4" class="last_volumes text-center" >Vol. On</th>                                                 
                                                <th rowspan="2" class="last-description">Comment</th>
                                                <% if(hasAccessUpTo != 'AM' && retrievalRole != 'AM') {%>
                                                <th rowspan="2" class="action"></th>
                                                <% }else{
                                                    isOldDeliverables = 1;
                                                } %>    
                                            </tr>
                                            <tr role="row">
                                                <th>PM</th>
                                                <th>AM</th>
                                                <th class="last_volumes"><%= moment(dateData.thirdLastDate).format('DD-MM-YY'); %></th>
                                                <th class="last_volumes"><%= moment(dateData.secondLastDate).format('DD-MM-YY'); %></th>
                                                <th class="last_volumes"><%= moment(dateData.lastDate).format('DD-MM-YY'); %></th>
                                                <th class="last_volumes"><%= moment(dateData.dateSelected).format('DD-MM-YY'); %></th>                                               
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <%                                           
                                            let currentMonth = moment(new Date()).format('MM');
                                            let currentDay = moment(new Date()).format('DD');
                                            let selectedMonth = moment(dateData.dateSelected).format('MM');
                                            let selectedYear = moment(dateData.dateSelected).format('YYYY');
                                            
                                            let suspendedPriceHeads = []; 
                                            let inputHiddenRow = [];
                                            if(priceList.length > 0){
                                            let i=0;         
                                            let disableFields = '';
                                            let addClass = '';            
                                            priceList.forEach(function(priceRow){ 
                                            i++; 
                                            let changeVolume = 0;
                                            let changeDescription = '';
                                            let addchangeRequestClass = '';

                                            previousVolumes = '';  
                                            if (priceRow.approve_requested_volumes){
                                                approvedVolumes =  priceRow.approve_requested_volumes.split(',');
                                                addchangeRequestClass = 'underline';
                                                previousVolumes = approvedVolumes.join('; ');
                                            }  

                                            if (priceRow.panding_change_request){
                                                changeDetails =  priceRow.panding_change_request.split('@@@');
                                                changeVolume = changeDetails[0];
                                                changeDescription = changeDetails[1];
                                                addchangeRequestClass = 'strike';
                                            }                                     
                                                
                                            if (isOldDeliverables ==1 || priceRow.is_custom || priceRow.client_status != 1){
                                                disableFields = 'disabled';
                                                addClass = 'hidden';
                                            }else{
                                                disableFields = '';
                                                addClass = '';
                                            }
                                            let dataForSort = priceRow.price_master_id;
                                            if(priceRow.is_custom){
                                                dataForSort = dataForSort+'_C';
                                            }else{
                                                dataForSort = dataForSort+'_S';
                                            }
                                            let dateSelected = new Date(dateData.dateSelected);
                                            let selectedDateToMatch = moment(dateSelected).format('DD-MM-YYYY');
                                            let lastDayOfSelectdMonth = new Date(dateSelected.getFullYear(), dateSelected.getMonth() + 1, 0);
                                            lastDayOfSelectdMonth = moment(lastDayOfSelectdMonth).format('DD-MM-YYYY');
                                            
                                            if(priceRow.status == 'S' || (dateData.clientStatus=='1' && priceRow.client_status ==2)){
                                                if(priceRow.status == 'S'){
                                                  suspendedPriceHeads.push(priceRow);
                                                }
                                                inputHiddenRow.push(priceRow); 
                                                
                                            
                                            }else{  inputTotal++;
                                            %>
                                                <tr class="price_row" id="<%= i %>" price-master-id ="<%= dataForSort %>" >                                                    
                                                    <td>
                                                        <%= priceRow.client_name %> 
                                                        <% if(priceRow.client_status == 2) { %>
                                                            (Blacklisted)
                                                        <% } %>
                                                    </td>
                                                   
                                                    <td>
                                                        <%= priceRow.invoice_item %>
                                                        <% if (priceRow.is_custom){%>
                                                        (Custom)
                                                        <% }%>
                                                    </td>
                                                    <% if(retrievalRole == 'AM') {%>
                                                        <td class="pm_name"><%= priceRow.pm_name%></td>
                                                    <%}%>  

                                                    <td>
                                                        <%= priceRow.price_unit%>
                                                    </td>

                                                    <td class="projected-volume" for-price-item="<%= priceRow.price_master_id%>" for-role = "PM">
                                                        <% if (!priceRow.is_custom) { 
                                                            if(priceRow.details_planned_monthly_volume_by_PM) { 
                                                                let details = priceRow.details_planned_monthly_volume_by_PM.split('@@@');
                                                                let planned_monthly_volume_by_PM = details[0];
                                                                let addedBy = details[1]+' '+ details[2];
                                                                addedBy = addedBy.trim();
                                                                let on = moment(new Date()).format('DD-MM-YYYY');
                                                                let toolTip = "Added by "+addedBy+" on "+on;
                                                                if(hasAccessUpTo != 'AM' && priceRow.client_status != 2){ %>
                                                                    <a href="javacript:void(0);" class="update-projected-volumes tooltips" title="<%= toolTip%>"><%= planned_monthly_volume_by_PM%></a>
                                                                <% }else{ %>
                                                                    <%= planned_monthly_volume_by_PM%>
                                                                <%}
                                                             }else{
                                                                if((currentMonth == selectedMonth ||(currentMonth - selectedMonth == 1 && currentDay == 1)) && hasAccessUpTo != 'AM' && priceRow.client_status != 2){
                                                            %>
                                                            <button type="button" class="btn btn-sm btn-success update-projected-volumes" >Add</button>
                                                        <%  } }
                                                        }
                                                        %>
                                                    </td>

                                                    <td class="projected-volume" for-price-item="<%= priceRow.price_master_id%>" for-role="AM">
                                                            <% if (!priceRow.is_custom) { 
                                                                if(priceRow.details_planned_monthly_volume_by_AM) { 
                                                                    let details = priceRow.details_planned_monthly_volume_by_AM.split('@@@');
                                                                    let planned_monthly_volume_by_AM = details[0];
                                                                    let addedBy = details[1]+' '+ details[2];
                                                                    addedBy = addedBy.trim();
                                                                    let on = moment(new Date()).format('DD-MM-YYYY');
                                                                    let toolTip = "Added by "+addedBy+" on "+on;
                                                                    if((['PM','GM'].indexOf(hasAccessUpTo) == -1) && priceRow.client_status != 2){ %>
                                                                    <a href="javacript:void(0);" class="update-projected-volumes tooltips" title="<%= toolTip%>" ><%= planned_monthly_volume_by_AM%></a>
                                                                    <% }else{ %>
                                                                        <%= planned_monthly_volume_by_AM%>
                                                                    <%}    
                                                                }else{
                                                                    if((currentMonth == selectedMonth || (currentMonth - selectedMonth == 1 && currentDay == 1)) && (['PM','GM'].indexOf(hasAccessUpTo) == -1) && priceRow.client_status != 2){
                                                                %>
                                                                <button type="button" class="btn btn-sm btn-success update-projected-volumes" >Add</button>
                                                            <%  } }
                                                            }
                                                            %>
                                                        </td>
                                                    
                                                    <td>
                                                        <%= (priceRow.last_month_volume!=null?parseFloat(priceRow.last_month_volume).toFixed(2):''); %>
                                                    </td>

                                                    <td class="mtdVol">
                                                        <%= (priceRow.mtd_volume!=null?parseFloat(priceRow.mtd_volume).toFixed(2):''); %>

                                                        <% if((lastDayOfSelectdMonth === selectedDateToMatch || currentMonth > selectedMonth) && priceRow.custom != 1) {
                                                            if(!priceRow.monthly_volume_sheet) {%>
                                                                <% if(retrievalRole != 'AM' && !priceRow.is_custom) {%>
                                                            <!-- <a href="#" data-target="#popupModelMTDVol" data-toggle="modal"> -->
                                                                <a title="Upload" href="#" id="mtdPopup" class="mtd-popup" data-priceMasteid="<%=priceRow.price_master_id %>"  data-is-custom="<%=priceRow.is_custom %>">
                                                                    <span class="glyphicon glyphicon-upload" style="font-size: 14px;"></span>
                                                                </a>
                                                                <% } %>
                                                        <% }else{ %>
                                                            <a title="Download" href="/delivery/download_mtd_file/<%= priceRow.monthly_volume_sheet %>" id="downloadMTDFile" data-priceMasteid="<%=priceRow.price_master_id %>" data-month="<%= selectedMonth%>" data-year="<%= selectedYear%>">
                                                                    <span class="glyphicon glyphicon-download" ></span>
                                                            </a>
                                                            <% if(retrievalRole != 'AM') {%>
                                                            <a title="Delete" href="#" id="deleteMTDFile" class="delete-mtd-file" data-pricemasterid="<%=priceRow.price_master_id %>" data-month="<%= selectedMonth%>" data-year="<%= selectedYear%>" data-is-custom="<%=priceRow.is_custom %>">
                                                                <span class="glyphicon glyphicon-trash"></span>
                                                            </a>
                                                            <%}%>
                                                        <%}}%>
                                                    </td>

                                                    <td>
                                                        <%= (priceRow.third_last_date_volume!=null?parseFloat(priceRow.third_last_date_volume).toFixed(2):''); %>
                                                    </td>

                                                    <td>
                                                        <%= (priceRow.second_last_date_volume!=null? parseFloat(priceRow.second_last_date_volume).toFixed(2):''); %>
                                                    </td>
                                                    <td>
                                                        <%= (priceRow.last_date_volume!=null?parseFloat(priceRow.last_date_volume).toFixed(2):''); %>                                                        
                                                    </td>
                                                                                                        
                                                    <td valign="middle" class="volume" volume-for="<%=priceRow.price_master_id %>">
                                                        <% if(dateData.clientStatus != 2) { %>
                                                        <input class="validate[required,custom[number]] prevent_submit <%= addClass%>" type="text" name="volume"  maxlength="6" size="5" value="<%= (priceRow.volume!=null?parseFloat(priceRow.volume).toFixed(2):''); %>" old-value="<%= (priceRow.volume!=null?parseFloat(priceRow.volume).toFixed(2):''); %>" <%= disableFields%> >
                                                        <% } if (isOldDeliverables ==1 && priceRow.volume>=0 ||dateData.clientStatus == 2){ %>
                                                            <div class="older">
                                                                    <div class="tooltip-vol current-data <%= addchangeRequestClass%>" approved-volumes ="<%= previousVolumes %>" title="<%= previousVolumes%>" data-toggle="tooltip" data-placement="left">
                                                                        <%= (priceRow.volume!=null?parseFloat(priceRow.volume).toFixed(2):''); %>
                                                                    </div>
                                                                    <% if (priceRow.panding_change_request){ %>
                                                                    <div class="changed-data">
                                                                        <%= (changeVolume!=null?parseFloat(changeVolume).toFixed(2):''); %>
                                                                    </div>
                                                                    <% } %> 
                                                            </div>
                                                        <% }%>
                                                    </td>
                                                    <td class="description">
                                                        
                                                        <textarea class="prevent_submit <%= addClass%>" name="description"  rows="1" cols="16" <%= disableFields%> ><%= priceRow.description %></textarea>
                                                        <% if (isOldDeliverables ==1 || priceRow.volume){ %>
                                                            <div class="older">
                                                                <div class="current-data <%= addchangeRequestClass%>">
                                                                    <%= priceRow.description %>
                                                                </div>
                                                                <% if (priceRow.panding_change_request){ %>
                                                                <div class="changed-data">
                                                                    <%= changeDescription %>
                                                                </div>
                                                                <% } %>                                                            
                                                            </div>
                                                        <% }%>
                                                    </td>

                                                    <% if(hasAccessUpTo != 'AM' && retrievalRole != 'AM'){ %>
                                                       
                                                        <td class="action">
                                                                <% if (!priceRow.is_custom && priceRow.client_status != 2) { %>                                                                
                                                                <% if(isOldDeliverables ==1){ %>
                                                                    <% if(!priceRow.panding_change_request){ %>
                                                                    <input name="deliverable_id" class="deliverable_id" type="hidden" value="<%= priceRow.deliverable_id%>" >
                                                                    <button type="button" class="btn btn-default edit-delivery" aria-label="Left Align" to-edit="<%=priceRow.price_master_id %>" title="Edit Deliverable.">
                                                                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                                                    </button>
                                                                    <div class="update-buttons hidden">
                                                                        <button type="button" class="btn btn-default update-delivery" aria-label="Left Align" to-update="<%=priceRow.price_master_id %>" title="Update Deliverable.">
                                                                            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                                                                        </button>
                                                                        <button type="button" class="btn btn-default cancel-update-delivery" aria-label="Left Align" cancel-update="<%=priceRow.price_master_id %>" title="Cancel Update.">
                                                                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                                                        </button>
                                                                    </div>
                                                                    <% } %>
                                                                <% } if(isexpiredDate != 1) {%>
                                                                <input class="required" type="hidden" name="priceMaster" required size="10" value="<%=priceRow.price_master_id %>" id="price_master_id" >
                                                                <button type="button" class="btn btn-default btn-suspend" aria-label="Left Align" id-to-suspend="<%=priceRow.price_master_id %>" name-to-suspend="<%=priceRow.invoice_item %>" title="Suspend Price Head.">
                                                                    <span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span>
                                                                </button>
                                                                <button type="button"  class="btn btn-default add_custom" aria-label="Left Align" add-custom-to="<%=priceRow.price_master_id %>" title="Add Custom Price">
                                                                    <span class="" aria-hidden="true"><i class="fa fa-plus"></i>CP</span>
                                                                </button>
                                                                
                                                            <% }} %>
                                                        </td>
                                                        <% } %>  
                                                </tr>
                                            <% 
                                                }
                                            }); 
                                            }else{%>
                                                <tr>
                                                    <% if(hasAccessUpTo == 'AM' || retrievalRole == 'AM') {%>
                                                        <td colspan="12"> No Pricing head found.</td>
                                                    <% }else{ %>
                                                        <td colspan="13"> No Pricing head found.</td> 
                                                    <% }%>
                                                </tr>
                                            <% } %>
                                        </tbody>
                                    </table>
                                    <% if(inputHiddenRow.length>0){
                                        inputHiddenRow.forEach(function(priceRow){

                                                %>
                                            <input  type="hidden" name="priceMaster" required size="10" value="<%=priceRow.price_master_id %>" id="price_master_id" >
                                            <input  type="hidden" name="description" value="<%= priceRow.description %>" >
                                            <input class="required" type="hidden" name="volume"  value="<%= (priceRow.volume!=null?parseFloat(priceRow.volume).toFixed(2):'0'); %>" old-value="<%= (priceRow.volume!=null?parseFloat(priceRow.volume).toFixed(2):'0'); %>" >
                                            <%
                                            })
                                    }%>
                                    <br>
                                    <div class="buttons">
                                    <% if(priceList.length > 0 && hasAccessUpTo != 'AM') { %>     
                                    <% if(isOldDeliverables != 1 && isexpiredDate != 1 && dateData.priceHeadStatus == 0 && dateData.clientStatus != 2) {%>
                                    <div class="pull-right ">
                                        <button type="button" class="btn btn-sm btn-success" id="saveDeliverables">Save</button>
                                        <!-- <button id="close_add_job" type="reset" class="btn btn-sm btn-danger" data-dismiss="modal">Reset</button> -->
                                    </div>
                                    <% } %>
                                   
                                        <div class="pull-right alert-danger">
                                            <% if(isexpiredDate == 1 && isOldDeliverables != 1) { %>
                                                You can not add the Daily Inputs for the selected date. Please contact to admin.
                                            <% } else if(dateData.priceHeadStatus != 0) { %>
                                                Daily Inputs can be added after clearing the filter of 'Pricing Head Status'.
                                            <% } else if(dateData.clientStatus == 2) { %>
                                                Daily Inputs can not be for Blacklisted clients.
                                            <% } %>
                                        </div>
                                    <% } %>
                                    </div>

                                </form>
                            </div>
                    </div>
                </div>
                <!--Editable Table Ends-->

            </div>
            <% if(retrievalRole != 'AM')  {%>
            <div class="panel">
                <div class="panel-heading">
                        Custom Price Heads
                </div>
                <div class="panel-body">
                        <table class="table table-striped table-hover table-bordered display dataTable no-footer table-fixed" id="customDeliverables">
        
                            <thead>                                            
                                <tr role="row">                                                   
                                    <th  width="15%">Client Name</th>
                                    <th >Pricing Head</th>
                                    <% if(retrievalRole == 'AM') {%>
                                    <th >PM</th>
                                    <%}%>    
                                    <th >U/M</th>                                                
                                    <th>Delivery Date </th>
                                    <th>Volume</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% customPriceHeads.forEach(function(head){%>
                                    <tr>
                                        <td><%= head.client_name%></td>
                                        <td><%= head.invoice_item%></td>
                                        <% if(retrievalRole == 'AM') {%>
                                        <td ><%= head.pm_name%></td>
                                        <%}%>
                                        <td><%= head.price_unit%></td>
                                        <td><%= moment(head.delivery_date).format('DD-MM-YYYY')%></td>
                                        <td><%= head.volume%></td>
                                    </tr>
                                <% })%>
                                
                            </tbody>
                        </table>
                    </div>
            </div>
            <% } %>
        </div>
        <div id="popupModel" class="modal" role="dialog"> 
            <div class="modal-dialog" >
    
            <!-- Modal content-->
                <div class="modal-content"> 
                    <form >
                            <div id="addCutom">

                            </div>
                            <input type="hidden" name="start_date" id="date_selected" value="<%= dateData.dateSelected%>">
                            <input type="hidden" name="end_date" id="end_date" value="<%= dateData.dateSelected%>">
                    </form> 
                </div>
            </div>
        </div>

        <div id="popupModelMTDVol" class="modal" role="dialog"> 
            <div class="modal-dialog" >
                <div class="modal-content"> 
                    <div class="modal-header">
                        <h4 class="modal-title">Add MTD Volumes File</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" id="closeUpload">×</button>
                    </div>
                    <div class="modal-body">
                    <div class="form-group">
                        <form id="mtdFileDetails">
                            <div class="well">
                                <div class="dropzone"></div>
                                <!-- <div id="added_files"></div> -->
                                <input type="hidden" name="selected_month" id="selectedMonth" value="<%= selectedMonth %>" >
                                <input type="hidden" name="selected_year" id="selectedYear" value="<%= selectedYear %>" >
                                <input type="hidden" name="price_master_id" id="priceMasterId" value="" >
                                <input class="validate[required]" type="text" name="mtd_original_file" id="mtdOriginalFile" value="" readonly >
                                <input class="hidden" type="hidden" name="mtd_file" id="mtdFile" value="" >
                                <input type="hidden" name="file_extension" id="fileExtension" value="">
                                <input type="hidden" name="is_custom_price" id="isCustomPrice" value="" >
                            </div> 
                        </form>           
                    </div>
                    </div>
                    <div class="modal-footer">
                        <div class="pull-right">
                            <!-- <button type="reset" class="btn btn-sm btn-danger">Reset</button> -->
                            <button type="button" class="btn btn-sm btn-success" id="saveMTDVolFile">Save</button>
                        </div>
                    </div>
                 </div>
            </div>
        </div>


        <div id="popupSuspendedPrice" class="modal" role="dialog"> 
            <div class="modal-dialog" >
                <div class="modal-content"> 
                    <div class="modal-header">
                        <h4 class="modal-title">Suspended Price Heads</h4>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" >×</button>
                    </div>
                    <div class="modal-body">
                    <div class="form-group">
                        <table class="table table-striped table-hover table-bordered display dataTable no-footer">
                            <thead>                                            
                                <tr role="row" > 
                                    <th rowspan="2" width="35%">Client Name</th>
                                    <th rowspan="2" width="55%">Pricing Head</th>
                                    <th rowspan="2">U/M</th>
                                </tr>
                            </thead>
                            <tbody>
                            <%
                            if(suspendedPriceHeads.length > 0){
                             suspendedPriceHeads.forEach(function(priceHead){ %>   
                                <tr>
                                    <td><%= priceHead.client_name %></td>
                                    <td><%= priceHead.invoice_item %></td>
                                    <td><%= priceHead.price_unit %></td>
                                    
                                </tr> 
                            <% }); 
                            }else{%>
                                <tr><td colspan="3">No suspended price head found.</td></tr>
                            <% } %>
                            </tbody>
                        </table>
                    </div>
                    </div>
                    <div class="modal-footer">
                        <div class="pull-right">
                            <!-- <button type="reset" class="btn btn-sm btn-danger">Reset</button> -->
                            <button type="button" class="btn btn-default" data-dismiss="modal" >Close</button>
                        </div>
                    </div>
                 </div>
            </div>
        </div>

        </div>
        <!--Content Wrapper Ends-->
        
        <script src="<%=assetsLocation%>/js/delivery.js"></script>
        <script src="<%=assetsLocation%>/js/dropzone.js"></script>          
        <script src="<%=assetsLocation%>/js/data-tables/js/dataTables.fixedHeader.min.js"></script>      
        <script>
            $(function(){
                if($('#dailyDeliverables').length > 0){
                    $('#dailyDeliverables').DataTable({
                        paging :false,
                        ordering: false,
                        fixedHeader: true,
                        searching:false, 
                        sDom: '<"top"><"bottom"><"clear">'
                    });
                }
            });
        </script>
        <% include ../layout/footer %>